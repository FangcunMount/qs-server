basePath: /api/v1
definitions:
  core.Response:
    properties:
      code:
        description: Code 业务状态码，0 表示成功
        type: integer
      data:
        description: Data 响应数据
      message:
        description: Message 响应消息
        type: string
      reference:
        description: Reference 返回参考文档（错误时使用）
        type: string
    type: object
  meta.ID:
    enum:
    - 0
    format: int64
    type: integer
    x-enum-varnames:
    - ZeroID
  request.AddQuestionRequest:
    properties:
      code:
        type: string
      description:
        type: string
      options:
        items:
          $ref: '#/definitions/viewmodel.OptionDTO'
        type: array
      required:
        type: boolean
      stem:
        type: string
      type:
        type: string
    type: object
  request.ApplyCodeRequest:
    properties:
      count:
        type: integer
      kind:
        type: string
      metadata:
        additionalProperties: true
        type: object
      prefix:
        type: string
    type: object
  request.BatchEvaluateRequest:
    properties:
      assessment_ids:
        description: 测评ID列表
        items:
          type: integer
        type: array
    type: object
  request.BatchUpdateFactorsRequest:
    properties:
      factors:
        items:
          $ref: '#/definitions/request.FactorModel'
        type: array
    type: object
  request.BatchUpdateQuestionsRequest:
    properties:
      questions:
        items:
          $ref: '#/definitions/viewmodel.QuestionDTO'
        type: array
    type: object
  request.CreatePlanRequest:
    properties:
      fixed_dates:
        description: 固定日期列表（用于 fixed_date，格式：YYYY-MM-DD）
        items:
          type: string
        type: array
      interval:
        description: 间隔（用于 by_week/by_day）
        type: integer
      relative_weeks:
        description: 相对周次列表（用于 custom，如 [2,4,8,12]）
        items:
          type: integer
        type: array
      scale_code:
        type: string
      schedule_type:
        type: string
      total_times:
        description: 总次数（用于 by_week/by_day）
        type: integer
    type: object
  request.CreateQuestionnaireRequest:
    properties:
      description:
        type: string
      img_url:
        type: string
      title:
        type: string
      type:
        type: string
    type: object
  request.CreateScaleRequest:
    properties:
      applicable_ages:
        items:
          type: string
        type: array
      category:
        type: string
      description:
        type: string
      questionnaire_code:
        type: string
      questionnaire_version:
        type: string
      reporters:
        items:
          type: string
        type: array
      stages:
        items:
          type: string
        type: array
      tags:
        items:
          type: string
        type: array
      title:
        type: string
    type: object
  request.CreateStaffRequest:
    properties:
      email:
        description: 邮箱
        type: string
      is_active:
        description: 是否激活
        type: boolean
      name:
        description: 姓名
        type: string
      org_id:
        description: 机构ID
        type: integer
      phone:
        description: 电话
        type: string
      roles:
        description: 角色列表
        items:
          type: string
        minItems: 1
        type: array
    required:
    - name
    - org_id
    - roles
    type: object
  request.EnrollTesteeRequest:
    properties:
      plan_id:
        type: string
      start_date:
        description: 格式：YYYY-MM-DD
        type: string
      testee_id:
        type: string
    type: object
  request.FactorInterpretRulesModel:
    properties:
      factor_code:
        type: string
      interpret_rules:
        items:
          $ref: '#/definitions/request.InterpretRuleModel'
        type: array
    type: object
  request.FactorModel:
    properties:
      code:
        type: string
      factor_type:
        type: string
      interpret_rules:
        items:
          $ref: '#/definitions/request.InterpretRuleModel'
        type: array
      is_show:
        description: 是否显示（用于报告中的维度展示）
        type: boolean
      is_total_score:
        type: boolean
      max_score:
        description: 最大分
        type: number
      question_codes:
        items:
          type: string
        type: array
      risk_level:
        description: 因子级别的风险等级（用于批量设置，如果解读规则未指定则使用此值）
        type: string
      scoring_params:
        $ref: '#/definitions/request.ScoringParamsModel'
      scoring_strategy:
        type: string
      title:
        type: string
    type: object
  request.InterpretRuleModel:
    properties:
      conclusion:
        type: string
      max_score:
        type: number
      min_score:
        type: number
      risk_level:
        type: string
      suggestion:
        type: string
    type: object
  request.OpenTaskRequest:
    properties:
      entry_token:
        type: string
      entry_url:
        type: string
      expire_at:
        description: 格式：YYYY-MM-DD HH:mm:ss
        type: string
    type: object
  request.ReorderQuestionsRequest:
    properties:
      question_codes:
        items:
          type: string
        type: array
    type: object
  request.ReplaceInterpretRulesRequest:
    properties:
      factor_rules:
        items:
          $ref: '#/definitions/request.FactorInterpretRulesModel'
        type: array
    type: object
  request.ResumePlanRequest:
    properties:
      testee_start_dates:
        additionalProperties:
          type: string
        description: 受试者ID -> 开始日期（格式：YYYY-MM-DD）
        type: object
    type: object
  request.ScoringParamsModel:
    properties:
      cnt_option_contents:
        description: 计数策略（cnt）专用参数
        items:
          type: string
        type: array
    type: object
  request.UpdateQuestionRequest:
    properties:
      code:
        type: string
      description:
        type: string
      options:
        items:
          $ref: '#/definitions/viewmodel.OptionDTO'
        type: array
      required:
        type: boolean
      stem:
        type: string
      type:
        type: string
    type: object
  request.UpdateQuestionnaireBasicInfoRequest:
    properties:
      description:
        type: string
      img_url:
        type: string
      title:
        type: string
      type:
        type: string
    type: object
  request.UpdateScaleBasicInfoRequest:
    properties:
      applicable_ages:
        items:
          type: string
        type: array
      category:
        type: string
      description:
        type: string
      reporters:
        items:
          type: string
        type: array
      stages:
        items:
          type: string
        type: array
      tags:
        items:
          type: string
        type: array
      title:
        type: string
    type: object
  request.UpdateScaleQuestionnaireRequest:
    properties:
      questionnaire_code:
        type: string
      questionnaire_version:
        type: string
    type: object
  request.UpdateTesteeRequest:
    properties:
      birthday:
        description: 出生日期
        type: string
      gender:
        description: 性别
        type: string
      is_key_focus:
        description: 是否重点关注
        type: boolean
      name:
        description: 姓名
        type: string
      tags:
        description: 标签
        items:
          type: string
        type: array
    type: object
  response.AnswerSheetListResponse:
    properties:
      items:
        items:
          $ref: '#/definitions/response.AnswerSheetSummaryItem'
        type: array
      total:
        type: integer
    type: object
  response.AnswerSheetResponse:
    properties:
      answers:
        items:
          $ref: '#/definitions/viewmodel.AnswerDTO'
        type: array
      filled_at:
        type: string
      filler_id:
        $ref: '#/definitions/meta.ID'
      filler_name:
        type: string
      id:
        $ref: '#/definitions/meta.ID'
      questionnaire_code:
        type: string
      questionnaire_ver:
        type: string
      score:
        type: number
      title:
        type: string
    type: object
  response.AnswerSheetSummaryItem:
    properties:
      filled_at:
        type: string
      filler_id:
        $ref: '#/definitions/meta.ID'
      id:
        $ref: '#/definitions/meta.ID'
      questionnaire_code:
        type: string
      questionnaire_ver:
        type: string
      score:
        type: number
      title:
        type: string
    type: object
  response.ApplicableAgeResponse:
    properties:
      label:
        type: string
      value:
        type: string
    type: object
  response.ApplyCodeResponse:
    properties:
      codes:
        items:
          type: string
        type: array
      count:
        type: integer
    type: object
  response.AssessmentListResponse:
    properties:
      items:
        description: 测评列表
        items:
          $ref: '#/definitions/response.AssessmentResponse'
        type: array
      page:
        description: 当前页
        type: integer
      page_size:
        description: 每页数量
        type: integer
      total:
        description: 总数
        type: integer
      total_pages:
        description: 总页数
        type: integer
    type: object
  response.AssessmentResponse:
    properties:
      answer_sheet_id:
        description: 答卷ID
        type: string
      failed_at:
        type: string
      failure_reason:
        type: string
      id:
        description: 测评ID
        type: string
      interpreted_at:
        type: string
      medical_scale_code:
        description: 量表编码
        type: string
      medical_scale_id:
        description: 量表ID
        type: string
      medical_scale_name:
        description: 量表名称
        type: string
      org_id:
        description: 组织ID
        type: string
      origin_id:
        description: 来源ID
        type: string
      origin_type:
        description: 来源类型
        type: string
      questionnaire_code:
        description: 问卷编码（唯一标识）
        type: string
      questionnaire_version:
        description: 问卷版本
        type: string
      risk_level:
        description: 风险等级
        type: string
      status:
        description: 状态
        type: string
      submitted_at:
        description: 提交时间
        type: string
      testee_id:
        description: 受试者ID
        type: string
      total_score:
        description: 总分
        type: number
    type: object
  response.AssessmentStatsResponse:
    properties:
      last_assessment_at:
        description: 最后测评时间
        type: string
      last_risk_level:
        description: 最后风险等级
        type: string
      total_count:
        description: 总次数
        type: integer
    type: object
  response.BatchEvaluationResponse:
    properties:
      failed_count:
        description: 失败数
        type: integer
      failed_ids:
        description: 失败的测评ID列表
        items:
          type: string
        type: array
      success_count:
        description: 成功数
        type: integer
      total_count:
        description: 总数
        type: integer
    type: object
  response.CategoryResponse:
    properties:
      label:
        type: string
      value:
        type: string
    type: object
  response.DimensionItem:
    properties:
      description:
        description: 解读描述
        type: string
      factor_code:
        description: 因子编码
        type: string
      factor_name:
        description: 因子名称
        type: string
      max_score:
        description: 最大分
        type: number
      raw_score:
        description: 原始分
        type: number
      risk_level:
        description: 风险等级
        type: string
      suggestion:
        description: 维度建议
        type: string
    type: object
  response.EnrollmentResponse:
    properties:
      plan_id:
        type: string
      tasks:
        items:
          $ref: '#/definitions/response.TaskResponse'
        type: array
    type: object
  response.FactorListResponse:
    properties:
      factors:
        items:
          $ref: '#/definitions/response.FactorResponse'
        type: array
    type: object
  response.FactorResponse:
    properties:
      code:
        type: string
      factor_type:
        type: string
      interpret_rules:
        items:
          $ref: '#/definitions/response.InterpretRuleResponse'
        type: array
      is_show:
        description: 是否显示（用于报告中的维度展示）
        type: boolean
      is_total_score:
        type: boolean
      max_score:
        description: 最大分
        type: number
      question_codes:
        items:
          type: string
        type: array
      risk_level:
        description: 因子级别的风险等级（从解读规则中提取）
        type: string
      scoring_params:
        additionalProperties: true
        type: object
      scoring_strategy:
        type: string
      title:
        type: string
    type: object
  response.FactorScoreItem:
    properties:
      conclusion:
        description: 结论
        type: string
      factor_code:
        description: 因子编码
        type: string
      factor_name:
        description: 因子名称
        type: string
      is_total_score:
        description: 是否为总分因子
        type: boolean
      max_score:
        description: 最大分
        type: number
      raw_score:
        description: 原始分
        type: number
      risk_level:
        description: 风险等级
        type: string
      suggestion:
        description: 建议
        type: string
    type: object
  response.FactorTrendResponse:
    properties:
      data_points:
        description: 数据点列表
        items:
          $ref: '#/definitions/response.TrendDataPoint'
        type: array
      factor_code:
        description: 因子编码
        type: string
      factor_name:
        description: 因子名称
        type: string
      testee_id:
        description: 受试者ID
        type: string
    type: object
  response.GuardianResponse:
    properties:
      name:
        type: string
      phone:
        type: string
      relation:
        type: string
    type: object
  response.HighRiskFactorsResponse:
    properties:
      assessment_id:
        description: 测评ID
        type: string
      has_high_risk:
        description: 是否存在高风险
        type: boolean
      high_risk_factors:
        description: 高风险因子列表
        items:
          $ref: '#/definitions/response.FactorScoreItem'
        type: array
      needs_urgent_care:
        description: 是否需要紧急关注
        type: boolean
    type: object
  response.InterpretRuleResponse:
    properties:
      conclusion:
        type: string
      max_score:
        type: number
      min_score:
        type: number
      risk_level:
        type: string
      suggestion:
        type: string
    type: object
  response.PeriodicProjectResponse:
    properties:
      completed_weeks:
        description: 已完成周数
        type: integer
      completion_rate:
        description: 完成率（0-100）
        type: number
      current_week:
        description: 当前应该完成的周次
        type: integer
      end_date:
        description: 项目结束日期
        type: string
      project_id:
        description: 项目ID
        type: string
      project_name:
        description: 项目名称
        type: string
      scale_name:
        description: 关联的量表名称
        type: string
      start_date:
        description: 项目开始日期
        type: string
      tasks:
        description: 各周任务状态（按周次升序排列）
        items:
          $ref: '#/definitions/response.PeriodicTaskResponse'
        type: array
      total_weeks:
        description: 总周数
        type: integer
    type: object
  response.PeriodicStatsResponse:
    properties:
      active_projects:
        description: 进行中的项目数
        type: integer
      projects:
        description: 周期性项目列表
        items:
          $ref: '#/definitions/response.PeriodicProjectResponse'
        type: array
      total_projects:
        description: 项目总数
        type: integer
    type: object
  response.PeriodicTaskResponse:
    properties:
      assessment_id:
        description: 关联的测评ID（如已完成）
        type: string
      completed_at:
        description: 完成时间
        type: string
      due_date:
        description: 截止时间
        type: string
      status:
        description: 状态：completed/pending/overdue
        type: string
      week:
        description: 第几周（从1开始）
        type: integer
    type: object
  response.PlanListResponse:
    properties:
      page:
        type: integer
      page_size:
        type: integer
      plans:
        items:
          $ref: '#/definitions/response.PlanResponse'
        type: array
      total_count:
        type: integer
    type: object
  response.PlanResponse:
    properties:
      fixed_dates:
        description: 固定日期列表（用于 fixed_date）
        items:
          type: string
        type: array
      id:
        description: 计划ID
        type: string
      interval:
        description: 间隔（周/天，用于 by_week/by_day）
        type: integer
      org_id:
        description: 机构ID
        type: integer
      relative_weeks:
        description: 相对周次列表（用于 custom）
        items:
          type: integer
        type: array
      scale_code:
        description: 量表编码（如 "3adyDE"）
        type: string
      schedule_type:
        description: 周期类型：by_week/by_day/fixed_date/custom
        type: string
      status:
        description: 状态：active/paused/finished/canceled
        type: string
      total_times:
        description: 总次数（用于 by_week/by_day）
        type: integer
    type: object
  response.QRCodeResponse:
    properties:
      qrcode_url:
        description: 二维码 URL
        type: string
    type: object
  response.QuestionnaireListResponse:
    properties:
      page:
        type: integer
      page_size:
        type: integer
      questionnaires:
        items:
          $ref: '#/definitions/response.QuestionnaireResponse'
        type: array
      total_count:
        type: integer
    type: object
  response.QuestionnaireResponse:
    properties:
      code:
        type: string
      description:
        type: string
      img_url:
        type: string
      questions:
        items:
          $ref: '#/definitions/viewmodel.QuestionDTO'
        type: array
      status:
        type: string
      title:
        type: string
      type:
        type: string
      version:
        type: string
    type: object
  response.ReportListResponse:
    properties:
      items:
        description: 报告列表
        items:
          $ref: '#/definitions/response.ReportResponse'
        type: array
      page:
        description: 当前页
        type: integer
      page_size:
        description: 每页数量
        type: integer
      total:
        description: 总数
        type: integer
      total_pages:
        description: 总页数
        type: integer
    type: object
  response.ReportResponse:
    properties:
      assessment_id:
        description: 测评ID
        type: string
      conclusion:
        description: 总结论
        type: string
      created_at:
        description: 创建时间
        type: string
      dimensions:
        description: 维度解读列表
        items:
          $ref: '#/definitions/response.DimensionItem'
        type: array
      risk_level:
        description: 风险等级
        type: string
      scale_code:
        description: 量表编码
        type: string
      scale_name:
        description: 量表名称
        type: string
      suggestions:
        description: 建议列表
        items:
          $ref: '#/definitions/response.SuggestionItem'
        type: array
      total_score:
        description: 总分
        type: number
    type: object
  response.ReporterResponse:
    properties:
      label:
        type: string
      value:
        type: string
    type: object
  response.ScaleAnalysisResponse:
    properties:
      scales:
        description: 量表趋势列表
        items:
          $ref: '#/definitions/response.ScaleTrendResponse'
        type: array
    type: object
  response.ScaleCategoriesResponse:
    properties:
      applicable_ages:
        items:
          $ref: '#/definitions/response.ApplicableAgeResponse'
        type: array
      categories:
        items:
          $ref: '#/definitions/response.CategoryResponse'
        type: array
      reporters:
        items:
          $ref: '#/definitions/response.ReporterResponse'
        type: array
      stages:
        items:
          $ref: '#/definitions/response.StageResponse'
        type: array
      tags:
        items:
          $ref: '#/definitions/response.TagResponse'
        type: array
    type: object
  response.ScaleFactorResponse:
    properties:
      factor_code:
        description: 因子编码
        type: string
      factor_name:
        description: 因子名称
        type: string
      percentile:
        description: 百分位
        type: number
      raw_score:
        description: 原始分
        type: number
      risk_level:
        description: 风险等级：normal/medium/high
        type: string
      t_score:
        description: T分
        type: number
    type: object
  response.ScaleListResponse:
    properties:
      page:
        type: integer
      page_size:
        type: integer
      scales:
        items:
          $ref: '#/definitions/response.ScaleResponse'
        type: array
      total_count:
        type: integer
    type: object
  response.ScaleResponse:
    properties:
      applicable_ages:
        items:
          type: string
        type: array
      category:
        type: string
      code:
        type: string
      created_at:
        description: 创建时间
        type: string
      created_by:
        description: 创建人
        type: string
      description:
        type: string
      factors:
        items:
          $ref: '#/definitions/response.FactorResponse'
        type: array
      questionnaire_code:
        type: string
      questionnaire_version:
        type: string
      reporters:
        items:
          type: string
        type: array
      stages:
        items:
          type: string
        type: array
      status:
        type: string
      tags:
        items:
          type: string
        type: array
      title:
        type: string
      updated_at:
        description: 更新时间
        type: string
      updated_by:
        description: 更新人
        type: string
    type: object
  response.ScaleTestResponse:
    properties:
      assessment_id:
        description: 测评ID
        type: string
      factors:
        description: 各因子得分
        items:
          $ref: '#/definitions/response.ScaleFactorResponse'
        type: array
      result:
        description: 结果描述，如："轻度焦虑"
        type: string
      risk_level:
        description: 风险等级：normal/medium/high
        type: string
      test_date:
        description: 测评日期
        type: string
      total_score:
        description: 总分
        type: number
    type: object
  response.ScaleTrendResponse:
    properties:
      scale_code:
        description: 量表编码
        type: string
      scale_id:
        description: 量表ID
        type: string
      scale_name:
        description: 量表名称
        type: string
      tests:
        description: 测评历史记录（按时间升序排列）
        items:
          $ref: '#/definitions/response.ScaleTestResponse'
        type: array
    type: object
  response.ScoreResponse:
    properties:
      assessment_id:
        description: 测评ID
        type: string
      factor_scores:
        description: 因子得分列表
        items:
          $ref: '#/definitions/response.FactorScoreItem'
        type: array
      risk_level:
        description: 整体风险等级
        type: string
      total_score:
        description: 总分
        type: number
    type: object
  response.StaffListResponse:
    properties:
      items:
        description: 列表数据
        items:
          $ref: '#/definitions/response.StaffResponse'
        type: array
      page:
        description: 当前页码
        type: integer
      page_size:
        description: 每页数量
        type: integer
      total:
        description: 总数
        type: integer
      total_pages:
        description: 总页数
        type: integer
    type: object
  response.StaffResponse:
    properties:
      created_at:
        description: 创建时间
        type: string
      email:
        description: 邮箱
        type: string
      id:
        description: ID
        type: string
      is_active:
        description: 是否激活
        type: boolean
      name:
        description: 姓名
        type: string
      org_id:
        description: 机构ID
        type: string
      phone:
        description: 电话
        type: string
      roles:
        description: 角色列表
        items:
          type: string
        type: array
      updated_at:
        description: 更新时间
        type: string
      user_id:
        description: 用户ID
        type: string
    type: object
  response.StageResponse:
    properties:
      label:
        type: string
      value:
        type: string
    type: object
  response.SuggestionItem:
    properties:
      category:
        description: 建议分类
        type: string
      content:
        description: 建议内容
        type: string
      factor_code:
        description: 关联因子编码
        type: string
    type: object
  response.TagResponse:
    properties:
      category:
        type: string
      label:
        type: string
      value:
        type: string
    type: object
  response.TaskListResponse:
    properties:
      page:
        type: integer
      page_size:
        type: integer
      tasks:
        items:
          $ref: '#/definitions/response.TaskResponse'
        type: array
      total_count:
        type: integer
    type: object
  response.TaskResponse:
    properties:
      assessment_id:
        description: 关联的测评ID
        type: string
      completed_at:
        description: 完成时间
        type: string
      entry_token:
        description: 入口令牌
        type: string
      entry_url:
        description: 入口URL
        type: string
      expire_at:
        description: 截止时间
        type: string
      id:
        description: 任务ID
        type: string
      open_at:
        description: 实际开放时间
        type: string
      org_id:
        description: 机构ID
        type: integer
      plan_id:
        description: 计划ID
        type: string
      planned_at:
        description: 计划时间点
        type: string
      scale_code:
        description: 量表编码（如 "3adyDE"）
        type: string
      seq:
        description: 序号（计划内的第N次测评）
        type: integer
      status:
        description: 状态：pending/opened/completed/expired/canceled
        type: string
      testee_id:
        description: 受试者ID
        type: string
    type: object
  response.TesteeListResponse:
    properties:
      items:
        description: 列表数据
        items:
          $ref: '#/definitions/response.TesteeResponse'
        type: array
      page:
        description: 当前页码
        type: integer
      page_size:
        description: 每页数量
        type: integer
      total:
        description: 总数
        type: integer
      total_pages:
        description: 总页数
        type: integer
    type: object
  response.TesteeResponse:
    properties:
      assessment_stats:
        allOf:
        - $ref: '#/definitions/response.AssessmentStatsResponse'
        description: 测评统计
      birthday:
        description: 出生日期
        type: string
      created_at:
        description: 创建时间
        type: string
      gender:
        description: 性别
        type: string
      guardians:
        description: 监护人信息列表
        items:
          $ref: '#/definitions/response.GuardianResponse'
        type: array
      iam_child_id:
        description: IAM儿童ID（已废弃，向后兼容，等同于ProfileID）
        type: string
      id:
        description: ID
        type: string
      is_key_focus:
        description: 是否重点关注
        type: boolean
      name:
        description: 姓名
        type: string
      org_id:
        description: 机构ID
        type: string
      profile_id:
        description: 用户档案ID（新字段）
        type: string
      source:
        description: 来源
        type: string
      tags:
        description: 标签
        items:
          type: string
        type: array
      updated_at:
        description: 更新时间
        type: string
    type: object
  response.TrendDataPoint:
    properties:
      assessment_id:
        description: 测评ID
        type: string
      raw_score:
        description: 得分
        type: number
      risk_level:
        description: 风险等级
        type: string
    type: object
  statistics.DailyCount:
    properties:
      count:
        type: integer
      date:
        type: string
    type: object
  statistics.PlanStatistics:
    properties:
      active_testees:
        description: 活跃受试者数（有完成任务的）
        type: integer
      completed_tasks:
        description: 已完成任务数
        type: integer
      completion_rate:
        description: 完成率
        type: number
      enrolled_testees:
        description: 受试者统计
        type: integer
      expired_tasks:
        description: 已过期任务数
        type: integer
      org_id:
        type: integer
      pending_tasks:
        description: 待完成任务数
        type: integer
      plan_id:
        type: integer
      total_tasks:
        description: 任务统计
        type: integer
    type: object
  statistics.QuestionnaireStatistics:
    properties:
      completion_rate:
        description: 完成率 = TotalCompletions / TotalSubmissions
        type: number
      daily_trend:
        description: 趋势数据（近30天）
        items:
          $ref: '#/definitions/statistics.DailyCount'
        type: array
      last_7_days_count:
        description: 时间维度统计
        type: integer
      last_15_days_count:
        description: 近15天提交数
        type: integer
      last_30_days_count:
        description: 近30天提交数
        type: integer
      org_id:
        type: integer
      origin_distribution:
        additionalProperties:
          format: int64
          type: integer
        description: 来源分布
        type: object
      questionnaire_code:
        type: string
      total_completions:
        description: 总完成数（已解读）
        type: integer
      total_submissions:
        description: 基础统计
        type: integer
    type: object
  statistics.SystemStatistics:
    properties:
      answer_sheet_count:
        description: 答卷总数
        type: integer
      assessment_count:
        description: 测评总数
        type: integer
      assessment_status_distribution:
        additionalProperties:
          format: int64
          type: integer
        description: 状态分布
        type: object
      assessment_trend:
        description: 趋势数据（近30天）
        items:
          $ref: '#/definitions/statistics.DailyCount'
        type: array
      org_id:
        type: integer
      questionnaire_count:
        description: 基础数量统计
        type: integer
      testee_count:
        description: 受试者总数
        type: integer
      today_new_answer_sheets:
        description: 今日新增答卷
        type: integer
      today_new_assessments:
        description: 今日新增（每日凌晨清零）
        type: integer
      today_new_testees:
        description: 今日新增受试者
        type: integer
    type: object
  statistics.TesteeStatistics:
    properties:
      completed_assessments:
        description: 已完成测评数
        type: integer
      first_assessment_date:
        description: 首次测评日期
        type: string
      last_assessment_date:
        description: 时间维度
        type: string
      org_id:
        type: integer
      pending_assessments:
        description: 待完成测评数
        type: integer
      risk_distribution:
        additionalProperties:
          format: int64
          type: integer
        description: 风险分布
        type: object
      testee_id:
        type: integer
      total_assessments:
        description: 测评统计
        type: integer
    type: object
  viewmodel.AnswerDTO:
    properties:
      question_code:
        type: string
      question_type:
        type: string
      score:
        type: number
      value: {}
    type: object
  viewmodel.CalculationRuleDTO:
    properties:
      formula_type:
        description: 公式类型
        type: string
    type: object
  viewmodel.OptionDTO:
    properties:
      code:
        description: 选项ID，仅更新/编辑时提供
        type: string
      content:
        description: 选项内容
        type: string
      score:
        description: 选项分数（支持小数）
        type: number
    type: object
  viewmodel.QuestionDTO:
    properties:
      calculation_rule:
        allOf:
        - $ref: '#/definitions/viewmodel.CalculationRuleDTO'
        description: 问题算分规则（可选项，结构化题型）
      code:
        description: 问题ID，仅更新/编辑时提供
        type: string
      options:
        description: 问题选项（可选项，结构化题型）
        items:
          $ref: '#/definitions/viewmodel.OptionDTO'
        type: array
      placeholder:
        description: 特定属性
        type: string
      question_type:
        description: 问题题型：single_choice, multi_choice, text 等
        type: string
      show_controller:
        allOf:
        - $ref: '#/definitions/viewmodel.ShowControllerDTO'
        description: 显示控制器（可选项）
      stem:
        description: 问题题干
        type: string
      tips:
        description: 问题提示
        type: string
      validation_rules:
        description: 能力属性
        items:
          $ref: '#/definitions/viewmodel.ValidationRuleDTO'
        type: array
    type: object
  viewmodel.ShowControllerConditionDTO:
    properties:
      code:
        description: 问题编码
        type: string
      select_option_codes:
        description: 选中的选项编码列表
        items:
          type: string
        type: array
    type: object
  viewmodel.ShowControllerDTO:
    properties:
      questions:
        description: 条件问题列表
        items:
          $ref: '#/definitions/viewmodel.ShowControllerConditionDTO'
        type: array
      rule:
        description: 逻辑规则：and 或 or
        type: string
    type: object
  viewmodel.ValidationRuleDTO:
    properties:
      rule_type:
        description: 规则类型
        type: string
      target_value:
        description: 目标值
        type: string
    type: object
  waiter.StatusSummary:
    properties:
      risk_level:
        type: string
      status:
        description: pending/submitted/interpreted/failed
        type: string
      total_score:
        type: number
      updated_at:
        description: Unix timestamp
        type: integer
    type: object
info:
  contact: {}
  description: Questionnaire Scale API server (REST & gRPC)
  title: QS API Server
  version: "1.0"
paths:
  /api/v1/answersheets:
    get:
      consumes:
      - application/json
      description: 管理员查询答卷列表，支持多维度筛选
      parameters:
      - description: Bearer 用户令牌
        in: header
        name: Authorization
        required: true
        type: string
      - default: 1
        description: 页码
        in: query
        name: page
        type: integer
      - default: 10
        description: 每页数量
        in: query
        name: page_size
        type: integer
      - description: 问卷编码
        in: query
        name: questionnaire_code
        type: string
      - description: 填写人ID
        in: query
        name: filler_id
        type: string
      - description: 开始时间
        in: query
        name: start_time
        type: string
      - description: 结束时间
        in: query
        name: end_time
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.AnswerSheetListResponse'
              type: object
      summary: 查询答卷列表
      tags:
      - AnswerSheet-Management
  /api/v1/answersheets/{id}:
    get:
      consumes:
      - application/json
      description: 管理员查看答卷的完整信息
      parameters:
      - description: Bearer 用户令牌
        in: header
        name: Authorization
        required: true
        type: string
      - description: 答卷ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.AnswerSheetResponse'
              type: object
      summary: 获取答卷详情
      tags:
      - AnswerSheet-Management
  /api/v1/assessments/{id}/wait-report:
    get:
      description: 等待测评报告生成，支持长轮询机制。如果报告已生成则立即返回，否则等待最多 timeout 秒
      parameters:
      - description: 测评ID
        in: path
        name: id
        required: true
        type: string
      - default: 15
        description: 超时时间（秒）
        in: query
        maximum: 60
        minimum: 5
        name: timeout
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/waiter.StatusSummary'
              type: object
      summary: 长轮询等待报告生成
      tags:
      - Evaluation-Assessment
  /api/v1/codes/apply:
    post:
      consumes:
      - application/json
      parameters:
      - description: Bearer 用户令牌
        in: header
        name: Authorization
        type: string
      - description: 申请请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/request.ApplyCodeRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.ApplyCodeResponse'
              type: object
      summary: 申请唯一 code
      tags:
      - 系统
  /api/v1/evaluations/assessments:
    get:
      description: 分页查询测评列表
      parameters:
      - default: 1
        description: 页码
        in: query
        name: page
        type: integer
      - default: 10
        description: 每页数量
        in: query
        name: page_size
        type: integer
      - description: 状态筛选
        in: query
        name: status
        type: string
      - description: 受试者ID筛选
        in: query
        name: testee_id
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.AssessmentListResponse'
              type: object
      summary: 查询测评列表
      tags:
      - Evaluation-Assessment
  /api/v1/evaluations/assessments/{id}:
    get:
      description: 根据ID获取测评详细信息
      parameters:
      - description: 测评ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.AssessmentResponse'
              type: object
      summary: 获取测评详情
      tags:
      - Evaluation-Assessment
  /api/v1/evaluations/assessments/{id}/high-risk-factors:
    get:
      description: 获取指定测评的高风险因子列表
      parameters:
      - description: 测评ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.HighRiskFactorsResponse'
              type: object
      summary: 获取高风险因子
      tags:
      - Evaluation-Score
  /api/v1/evaluations/assessments/{id}/report:
    get:
      description: |-
        获取指定测评的解读报告。响应字段说明：
        - dimensions（维度列表）：每个维度包含 factor_code（因子编码）、factor_name（因子名称）、raw_score（原始分）、max_score（最大分，可选）、risk_level（风险等级）、description（解读描述）、suggestion（维度建议，字符串）字段
        - suggestions（建议列表）：报告级别的建议列表，每个建议包含 category（分类）、content（内容）、factor_code（关联因子编码，可选）字段
      parameters:
      - description: 测评ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.ReportResponse'
              type: object
      summary: 获取测评报告
      tags:
      - Evaluation-Report
  /api/v1/evaluations/assessments/{id}/retry:
    post:
      description: 重试指定测评的评估流程
      parameters:
      - description: 测评ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.AssessmentResponse'
              type: object
      summary: 重试失败的测评
      tags:
      - Evaluation-Admin
  /api/v1/evaluations/assessments/{id}/scores:
    get:
      description: 获取指定测评的得分详情。响应中的 factor_scores 包含每个因子的得分信息，其中 max_score 为因子的最大分（可选）
      parameters:
      - description: 测评ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.ScoreResponse'
              type: object
      summary: 获取测评得分
      tags:
      - Evaluation-Score
  /api/v1/evaluations/batch-evaluate:
    post:
      consumes:
      - application/json
      description: 批量执行测评评估（管理员/Worker使用）
      parameters:
      - description: 批量评估请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/request.BatchEvaluateRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.BatchEvaluationResponse'
              type: object
      summary: 批量评估
      tags:
      - Evaluation-Admin
  /api/v1/evaluations/reports:
    get:
      description: 查询指定受试者的报告列表。每个报告包含 dimensions（维度列表）和 suggestions（建议列表），维度中的 suggestion
        字段为字符串类型
      parameters:
      - description: 受试者ID
        in: query
        name: testee_id
        required: true
        type: string
      - default: 1
        description: 页码
        in: query
        name: page
        type: integer
      - default: 10
        description: 每页数量
        in: query
        name: page_size
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.ReportListResponse'
              type: object
      summary: 查询报告列表
      tags:
      - Evaluation-Report
  /api/v1/evaluations/scores/trend:
    get:
      description: 获取指定受试者某因子的历史得分趋势
      parameters:
      - description: 受试者ID
        in: query
        name: testee_id
        required: true
        type: string
      - description: 因子编码
        in: query
        name: factor_code
        required: true
        type: string
      - default: 10
        description: 返回记录数限制
        in: query
        name: limit
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.FactorTrendResponse'
              type: object
      summary: 获取因子趋势
      tags:
      - Evaluation-Score
  /api/v1/plans:
    get:
      description: 分页查询计划列表，支持条件筛选。可通过量表编码（scale_code）筛选特定量表的计划
      parameters:
      - description: Bearer 用户令牌
        in: header
        name: Authorization
        required: true
        type: string
      - description: 机构ID
        in: query
        name: org_id
        type: integer
      - description: 量表编码（如 '3adyDE'）
        in: query
        name: scale_code
        type: string
      - description: 状态（active/paused/finished/canceled）
        in: query
        name: status
        type: string
      - description: 页码（从1开始）
        in: query
        name: page
        required: true
        type: integer
      - description: 每页数量
        in: query
        name: page_size
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.PlanListResponse'
              type: object
      summary: 查询计划列表
      tags:
      - Plan-Query
    post:
      consumes:
      - application/json
      description: |-
        创建新的测评计划模板，定义周期策略。需要提供量表编码（scale_code）和周期类型（schedule_type）。不同周期类型需要不同的参数：
        - by_week/by_day: 需要 interval（间隔）和 total_times（总次数）
        - fixed_date: 需要 fixed_dates（固定日期列表）
        - custom: 需要 relative_weeks（相对周次列表）
      parameters:
      - description: Bearer 用户令牌
        in: header
        name: Authorization
        required: true
        type: string
      - description: '创建计划请求（scale_code: 量表编码，如 ''3adyDE''）'
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/request.CreatePlanRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.PlanResponse'
              type: object
      summary: 创建测评计划模板
      tags:
      - Plan-Lifecycle
  /api/v1/plans/{id}:
    get:
      description: 查询指定计划的完整信息
      parameters:
      - description: Bearer 用户令牌
        in: header
        name: Authorization
        required: true
        type: string
      - description: 计划ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.PlanResponse'
              type: object
      summary: 获取计划详情
      tags:
      - Plan-Query
  /api/v1/plans/{id}/cancel:
    post:
      description: 取消计划，不可恢复
      parameters:
      - description: Bearer 用户令牌
        in: header
        name: Authorization
        required: true
        type: string
      - description: 计划ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/core.Response'
      summary: 取消计划
      tags:
      - Plan-Lifecycle
  /api/v1/plans/{id}/pause:
    post:
      description: 暂停计划，取消所有未执行的任务
      parameters:
      - description: Bearer 用户令牌
        in: header
        name: Authorization
        required: true
        type: string
      - description: 计划ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.PlanResponse'
              type: object
      summary: 暂停计划
      tags:
      - Plan-Lifecycle
  /api/v1/plans/{id}/resume:
    post:
      consumes:
      - application/json
      description: 恢复计划，重新生成未完成的任务
      parameters:
      - description: Bearer 用户令牌
        in: header
        name: Authorization
        required: true
        type: string
      - description: 计划ID
        in: path
        name: id
        required: true
        type: string
      - description: 恢复计划请求（可选）
        in: body
        name: request
        schema:
          $ref: '#/definitions/request.ResumePlanRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.PlanResponse'
              type: object
      summary: 恢复计划
      tags:
      - Plan-Lifecycle
  /api/v1/plans/{id}/tasks:
    get:
      description: 查看某个计划的所有任务
      parameters:
      - description: Bearer 用户令牌
        in: header
        name: Authorization
        required: true
        type: string
      - description: 计划ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.TaskListResponse'
              type: object
      summary: 查询计划下的所有任务
      tags:
      - Plan-Query
  /api/v1/plans/{id}/testees/{testee_id}/terminate:
    post:
      description: 受试者退出计划，取消所有待处理任务
      parameters:
      - description: Bearer 用户令牌
        in: header
        name: Authorization
        required: true
        type: string
      - description: 计划ID
        in: path
        name: id
        required: true
        type: string
      - description: 受试者ID
        in: path
        name: testee_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/core.Response'
      summary: 终止受试者的计划参与
      tags:
      - Plan-Enrollment
  /api/v1/plans/enroll:
    post:
      consumes:
      - application/json
      description: 将受试者加入计划，生成所有任务
      parameters:
      - description: Bearer 用户令牌
        in: header
        name: Authorization
        required: true
        type: string
      - description: 加入计划请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/request.EnrollTesteeRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.EnrollmentResponse'
              type: object
      summary: 受试者加入计划
      tags:
      - Plan-Enrollment
  /api/v1/plans/tasks:
    get:
      description: 分页查询任务列表，支持条件筛选
      parameters:
      - description: Bearer 用户令牌
        in: header
        name: Authorization
        required: true
        type: string
      - description: 计划ID
        in: query
        name: plan_id
        type: string
      - description: 受试者ID
        in: query
        name: testee_id
        type: string
      - description: 状态
        in: query
        name: status
        type: string
      - description: 页码
        in: query
        name: page
        required: true
        type: integer
      - description: 每页数量
        in: query
        name: page_size
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.TaskListResponse'
              type: object
      summary: 查询任务列表
      tags:
      - Plan-Query
  /api/v1/plans/tasks/{id}:
    get:
      description: 查询指定任务的完整信息
      parameters:
      - description: Bearer 用户令牌
        in: header
        name: Authorization
        required: true
        type: string
      - description: 任务ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.TaskResponse'
              type: object
      summary: 获取任务详情
      tags:
      - Plan-Query
  /api/v1/plans/tasks/{id}/cancel:
    post:
      description: 手动取消任务
      parameters:
      - description: Bearer 用户令牌
        in: header
        name: Authorization
        required: true
        type: string
      - description: 任务ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/core.Response'
      summary: 取消任务
      tags:
      - Task-Management
  /api/v1/plans/tasks/{id}/complete:
    post:
      description: 用户完成测评后，更新任务状态
      parameters:
      - description: Bearer 用户令牌
        in: header
        name: Authorization
        required: true
        type: string
      - description: 任务ID
        in: path
        name: id
        required: true
        type: string
      - description: 测评ID
        in: query
        name: assessment_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.TaskResponse'
              type: object
      summary: 完成任务
      tags:
      - Task-Management
  /api/v1/plans/tasks/{id}/expire:
    post:
      description: 定时任务调用，标记已过期的任务
      parameters:
      - description: Bearer 用户令牌
        in: header
        name: Authorization
        required: true
        type: string
      - description: 任务ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.TaskResponse'
              type: object
      summary: 过期任务
      tags:
      - Task-Management
  /api/v1/plans/tasks/{id}/open:
    post:
      consumes:
      - application/json
      description: 手动开放任务，生成入口
      parameters:
      - description: Bearer 用户令牌
        in: header
        name: Authorization
        required: true
        type: string
      - description: 任务ID
        in: path
        name: id
        required: true
        type: string
      - description: 开放任务请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/request.OpenTaskRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.TaskResponse'
              type: object
      summary: 开放任务
      tags:
      - Task-Management
  /api/v1/plans/tasks/schedule:
    post:
      description: 定时任务调用，扫描待推送任务，生成入口并开放
      parameters:
      - description: Bearer 用户令牌
        in: header
        name: Authorization
        required: true
        type: string
      - description: 截止时间（格式：YYYY-MM-DD HH:mm:ss），默认当前时间
        in: query
        name: before
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.TaskListResponse'
              type: object
      summary: 调度待推送任务
      tags:
      - Task-Scheduler
  /api/v1/public/questionnaires:
    get:
      consumes:
      - application/json
      description: 分页查询已发布的问卷列表（C端答题使用）
      parameters:
      - default: 1
        description: 页码
        in: query
        name: page
        type: integer
      - default: 10
        description: 每页数量
        in: query
        name: page_size
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.QuestionnaireListResponse'
              type: object
      summary: 查询已发布问卷列表
      tags:
      - Questionnaire-Query
  /api/v1/public/questionnaires/{code}:
    get:
      consumes:
      - application/json
      description: 根据编码获取已发布的问卷（C端答题使用）
      parameters:
      - description: 问卷编码
        in: path
        name: code
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.QuestionnaireResponse'
              type: object
      summary: 获取已发布问卷
      tags:
      - Questionnaire-Query
  /api/v1/qrcodes/{filename}:
    get:
      description: 根据文件名获取二维码图片
      parameters:
      - description: 文件名，例如 questionnaire_3adyDE_v1.png 或 scale_3adyDE.png
        in: path
        name: filename
        required: true
        type: string
      produces:
      - image/png
      responses:
        "200":
          description: OK
          schema:
            type: file
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/core.Response'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/core.Response'
      summary: 获取二维码图片
      tags:
      - QRCode
  /api/v1/questionnaires:
    get:
      consumes:
      - application/json
      description: 分页查询问卷列表，支持条件筛选（管理端使用）
      parameters:
      - description: Bearer 用户令牌
        in: header
        name: Authorization
        required: true
        type: string
      - default: 1
        description: 页码
        in: query
        name: page
        type: integer
      - default: 10
        description: 每页数量
        in: query
        name: page_size
        type: integer
      - description: 状态筛选（draft/published/archived）
        in: query
        name: status
        type: string
      - description: 标题筛选
        in: query
        name: title
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.QuestionnaireListResponse'
              type: object
      summary: 查询问卷列表
      tags:
      - Questionnaire-Query
    post:
      consumes:
      - application/json
      description: 创建新问卷，初始状态为草稿
      parameters:
      - description: Bearer 用户令牌
        in: header
        name: Authorization
        required: true
        type: string
      - description: 创建问卷请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/request.CreateQuestionnaireRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.QuestionnaireResponse'
              type: object
      summary: 创建问卷
      tags:
      - Questionnaire-Lifecycle
  /api/v1/questionnaires/{code}:
    delete:
      consumes:
      - application/json
      description: 删除草稿状态的问卷
      parameters:
      - description: Bearer 用户令牌
        in: header
        name: Authorization
        required: true
        type: string
      - description: 问卷编码
        in: path
        name: code
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/core.Response'
      summary: 删除问卷
      tags:
      - Questionnaire-Lifecycle
    get:
      consumes:
      - application/json
      description: 根据编码获取问卷的完整信息（管理端使用）
      parameters:
      - description: Bearer 用户令牌
        in: header
        name: Authorization
        required: true
        type: string
      - description: 问卷编码
        in: path
        name: code
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.QuestionnaireResponse'
              type: object
      summary: 获取问卷详情
      tags:
      - Questionnaire-Query
  /api/v1/questionnaires/{code}/archive:
    post:
      consumes:
      - application/json
      description: 归档不再使用的问卷
      parameters:
      - description: Bearer 用户令牌
        in: header
        name: Authorization
        required: true
        type: string
      - description: 问卷编码
        in: path
        name: code
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.QuestionnaireResponse'
              type: object
      summary: 归档问卷
      tags:
      - Questionnaire-Lifecycle
  /api/v1/questionnaires/{code}/basic-info:
    put:
      consumes:
      - application/json
      description: 更新问卷的标题、描述、封面图
      parameters:
      - description: Bearer 用户令牌
        in: header
        name: Authorization
        required: true
        type: string
      - description: 问卷编码
        in: path
        name: code
        required: true
        type: string
      - description: 更新请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/request.UpdateQuestionnaireBasicInfoRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.QuestionnaireResponse'
              type: object
      summary: 更新问卷基本信息
      tags:
      - Questionnaire-Lifecycle
  /api/v1/questionnaires/{code}/draft:
    post:
      consumes:
      - application/json
      description: 保存问卷为草稿状态，小版本号递增
      parameters:
      - description: Bearer 用户令牌
        in: header
        name: Authorization
        required: true
        type: string
      - description: 问卷编码
        in: path
        name: code
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.QuestionnaireResponse'
              type: object
      summary: 保存草稿
      tags:
      - Questionnaire-Lifecycle
  /api/v1/questionnaires/{code}/publish:
    post:
      consumes:
      - application/json
      description: 发布问卷使其可用，大版本号递增
      parameters:
      - description: Bearer 用户令牌
        in: header
        name: Authorization
        required: true
        type: string
      - description: 问卷编码
        in: path
        name: code
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.QuestionnaireResponse'
              type: object
      summary: 发布问卷
      tags:
      - Questionnaire-Lifecycle
  /api/v1/questionnaires/{code}/qrcode:
    get:
      description: 根据问卷编码和版本获取小程序码
      parameters:
      - description: 问卷编码
        in: path
        name: code
        required: true
        type: string
      - description: 问卷版本（可选，默认使用最新版本）
        in: query
        name: version
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.QRCodeResponse'
              type: object
      summary: 获取问卷小程序码
      tags:
      - Questionnaire-Query
  /api/v1/questionnaires/{code}/questions:
    post:
      consumes:
      - application/json
      description: 向问卷添加新问题
      parameters:
      - description: Bearer 用户令牌
        in: header
        name: Authorization
        required: true
        type: string
      - description: 问卷编码
        in: path
        name: code
        required: true
        type: string
      - description: 添加问题请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/request.AddQuestionRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.QuestionnaireResponse'
              type: object
      summary: 添加问题
      tags:
      - Questionnaire-Content
  /api/v1/questionnaires/{code}/questions/{questionCode}:
    delete:
      consumes:
      - application/json
      description: 从问卷中删除某个问题
      parameters:
      - description: Bearer 用户令牌
        in: header
        name: Authorization
        required: true
        type: string
      - description: 问卷编码
        in: path
        name: code
        required: true
        type: string
      - description: 问题编码
        in: path
        name: questionCode
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.QuestionnaireResponse'
              type: object
      summary: 删除问题
      tags:
      - Questionnaire-Content
    put:
      consumes:
      - application/json
      description: 更新问卷中的某个问题
      parameters:
      - description: Bearer 用户令牌
        in: header
        name: Authorization
        required: true
        type: string
      - description: 问卷编码
        in: path
        name: code
        required: true
        type: string
      - description: 问题编码
        in: path
        name: questionCode
        required: true
        type: string
      - description: 更新问题请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/request.UpdateQuestionRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.QuestionnaireResponse'
              type: object
      summary: 更新问题
      tags:
      - Questionnaire-Content
  /api/v1/questionnaires/{code}/questions/batch:
    put:
      consumes:
      - application/json
      description: 批量更新问卷的所有问题（前端保存时使用）
      parameters:
      - description: Bearer 用户令牌
        in: header
        name: Authorization
        required: true
        type: string
      - description: 问卷编码
        in: path
        name: code
        required: true
        type: string
      - description: 批量更新请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/request.BatchUpdateQuestionsRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.QuestionnaireResponse'
              type: object
      summary: 批量更新问题
      tags:
      - Questionnaire-Content
  /api/v1/questionnaires/{code}/questions/reorder:
    post:
      consumes:
      - application/json
      description: 调整问卷中问题的显示顺序
      parameters:
      - description: Bearer 用户令牌
        in: header
        name: Authorization
        required: true
        type: string
      - description: 问卷编码
        in: path
        name: code
        required: true
        type: string
      - description: 重排问题请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/request.ReorderQuestionsRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.QuestionnaireResponse'
              type: object
      summary: 重排问题顺序
      tags:
      - Questionnaire-Content
  /api/v1/questionnaires/{code}/unpublish:
    post:
      consumes:
      - application/json
      description: 将已发布的问卷下架
      parameters:
      - description: Bearer 用户令牌
        in: header
        name: Authorization
        required: true
        type: string
      - description: 问卷编码
        in: path
        name: code
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.QuestionnaireResponse'
              type: object
      summary: 下架问卷
      tags:
      - Questionnaire-Lifecycle
  /api/v1/scales:
    get:
      consumes:
      - application/json
      description: 分页获取量表列表（摘要信息，不包含因子详情）。响应中包含分类字段：category（主类）、stages（阶段列表）、applicable_ages（使用年龄列表）、reporters（填报人列表）、tags（标签列表）。
      parameters:
      - description: Bearer 用户令牌
        in: header
        name: Authorization
        required: true
        type: string
      - description: 页码
        in: query
        name: page
        required: true
        type: integer
      - description: 每页数量
        in: query
        name: page_size
        required: true
        type: integer
      - description: 状态过滤（draft/published/archived）
        in: query
        name: status
        type: string
      - description: 标题模糊搜索
        in: query
        name: title
        type: string
      - description: 主类过滤
        in: query
        name: category
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.ScaleListResponse'
              type: object
      summary: 获取量表列表
      tags:
      - Scale-Query
    post:
      consumes:
      - application/json
      description: |-
        创建新量表，初始状态为草稿。支持设置主类、阶段、使用年龄、填报人和标签等分类信息。
        字段说明：
        - category: 主类，可选值：adhd(ADHD)、tic(抽动障碍)、sensory(感统)、executive(执行功能)、mental(心理健康)、neurodev(神经发育)、chronic(慢性病管理)、qol(生活质量)
        - stages: 阶段列表（数组），可选值：screening(筛查)、deep_assessment(深评)、follow_up(随访)、outcome(结局)，可多选
        - applicable_ages: 使用年龄列表（数组），可选值：infant(婴幼儿)、preschool(学龄前)、school_child(学龄儿童)、adolescent(青少年)、adult(成人)，可多选
        - reporters: 填报人列表（数组），可选值：parent(家长评)、teacher(教师评)、self(自评)、clinical(临床评定)，可多选
        - tags: 标签列表（数组），动态输入，最多5个，每个标签长度1-50字符，只能包含字母、数字、下划线和中文
      parameters:
      - description: Bearer 用户令牌
        in: header
        name: Authorization
        required: true
        type: string
      - description: 创建量表请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/request.CreateScaleRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.ScaleResponse'
              type: object
      summary: 创建量表
      tags:
      - Scale-Lifecycle
  /api/v1/scales/{code}:
    delete:
      consumes:
      - application/json
      description: 删除草稿状态的量表
      parameters:
      - description: Bearer 用户令牌
        in: header
        name: Authorization
        required: true
        type: string
      - description: 量表编码
        in: path
        name: code
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/core.Response'
      summary: 删除量表
      tags:
      - Scale-Lifecycle
    get:
      consumes:
      - application/json
      description: |-
        根据编码获取量表详情。
        响应字段说明：
        - category: 主类（adhd/tic/sensory/executive/mental/neurodev/chronic/qol）
        - stages: 阶段列表（数组，screening/deep_assessment/follow_up/outcome）
        - applicable_ages: 使用年龄列表（数组，infant/preschool/school_child/adolescent/adult）
        - reporters: 填报人列表（数组，可包含 parent/teacher/self/clinical）
        - tags: 标签列表（数组，动态输入）
        - scoring_params: 计分参数，map[string]interface{}，cnt 策略直接包含 cnt_option_contents 字段
        - max_score: 因子的最大分（可选）
        - is_show: 是否显示（用于报告中的维度展示）
        - risk_level: 因子级别的风险等级，从解读规则中提取（使用第一个规则的风险等级），有效值：none/low/medium/high/severe
      parameters:
      - description: Bearer 用户令牌
        in: header
        name: Authorization
        required: true
        type: string
      - description: 量表编码
        in: path
        name: code
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.ScaleResponse'
              type: object
      summary: 获取量表详情
      tags:
      - Scale-Query
  /api/v1/scales/{code}/archive:
    post:
      description: 归档量表。量表编码通过 URL 路径参数传递，不需要请求体。
      parameters:
      - description: Bearer 用户令牌
        in: header
        name: Authorization
        required: true
        type: string
      - description: 量表编码
        in: path
        name: code
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.ScaleResponse'
              type: object
      summary: 归档量表
      tags:
      - Scale-Lifecycle
  /api/v1/scales/{code}/basic-info:
    put:
      consumes:
      - application/json
      description: |-
        更新量表的标题、描述、主类、阶段、使用年龄、填报人和标签等分类信息。
        字段说明：
        - category: 主类，可选值：adhd(ADHD)、tic(抽动障碍)、sensory(感统)、executive(执行功能)、mental(心理健康)、neurodev(神经发育)、chronic(慢性病管理)、qol(生活质量)
        - stages: 阶段列表（数组），可选值：screening(筛查)、deep_assessment(深评)、follow_up(随访)、outcome(结局)，可多选
        - applicable_ages: 使用年龄列表（数组），可选值：infant(婴幼儿)、preschool(学龄前)、school_child(学龄儿童)、adolescent(青少年)、adult(成人)，可多选
        - reporters: 填报人列表（数组），可选值：parent(家长评)、teacher(教师评)、self(自评)、clinical(临床评定)，可多选
        - tags: 标签列表（数组），动态输入，最多5个，每个标签长度1-50字符，只能包含字母、数字、下划线和中文
      parameters:
      - description: Bearer 用户令牌
        in: header
        name: Authorization
        required: true
        type: string
      - description: 量表编码
        in: path
        name: code
        required: true
        type: string
      - description: 更新请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/request.UpdateScaleBasicInfoRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.ScaleResponse'
              type: object
      summary: 更新量表基本信息
      tags:
      - Scale-Lifecycle
  /api/v1/scales/{code}/factors:
    get:
      consumes:
      - application/json
      description: |-
        根据量表编码获取该量表的所有因子。响应中的 scoring_params 为 map[string]interface{}，cnt 策略直接包含 cnt_option_contents 字段
        响应中的 max_score 为因子的最大分（可选）
        响应中的 is_show 为是否显示（用于报告中的维度展示）
        响应中的 risk_level 为因子级别的风险等级，从解读规则中提取（使用第一个规则的风险等级），有效值：none/low/medium/high/severe
      parameters:
      - description: Bearer 用户令牌
        in: header
        name: Authorization
        required: true
        type: string
      - description: 量表编码
        in: path
        name: code
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.FactorListResponse'
              type: object
      summary: 获取量表的因子列表
      tags:
      - Scale-Query
  /api/v1/scales/{code}/factors/batch:
    put:
      consumes:
      - application/json
      description: |-
        批量更新量表的所有因子（前端保存时使用）。计分参数根据策略类型使用不同字段：
        - sum/avg 策略：scoring_params 可为空或省略
        - cnt 策略：scoring_params 必须包含 cnt_option_contents（选项内容数组，字符串数组），且不能为空
        - max_score：最大分（可选），用于设置因子的最大分数
        - is_show：是否显示（用于报告中的维度展示），默认为 true
        - risk_level：因子级别的风险等级（可选），如果解读规则中未指定风险等级，则使用此值；有效值：none/low/medium/high/severe
        响应中的 scoring_params 为 map[string]interface{}，cnt 策略直接包含 cnt_option_contents 字段
        响应中的 max_score 为因子的最大分（可选）
        响应中的 is_show 为是否显示字段
        响应中的 risk_level 为因子级别的风险等级，从解读规则中提取（使用第一个规则的风险等级）
      parameters:
      - description: Bearer 用户令牌
        in: header
        name: Authorization
        required: true
        type: string
      - description: 量表编码
        in: path
        name: code
        required: true
        type: string
      - description: 批量更新因子请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/request.BatchUpdateFactorsRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.ScaleResponse'
              type: object
      summary: 批量更新因子
      tags:
      - Scale-Factor
  /api/v1/scales/{code}/interpret-rules:
    put:
      consumes:
      - application/json
      description: |-
        批量设置量表所有因子的解读规则
        响应中的 max_score 为因子的最大分（可选）
        响应中的 is_show 为是否显示字段
        响应中的 risk_level 为因子级别的风险等级，从解读规则中提取（使用第一个规则的风险等级），有效值：none/low/medium/high/severe
      parameters:
      - description: Bearer 用户令牌
        in: header
        name: Authorization
        required: true
        type: string
      - description: 量表编码
        in: path
        name: code
        required: true
        type: string
      - description: 设置解读规则请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/request.ReplaceInterpretRulesRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.ScaleResponse'
              type: object
      summary: 批量设置解读规则
      tags:
      - Scale-Factor
  /api/v1/scales/{code}/publish:
    post:
      description: 发布量表使其可用。量表编码通过 URL 路径参数传递，不需要请求体。
      parameters:
      - description: Bearer 用户令牌
        in: header
        name: Authorization
        required: true
        type: string
      - description: 量表编码
        in: path
        name: code
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.ScaleResponse'
              type: object
      summary: 发布量表
      tags:
      - Scale-Lifecycle
  /api/v1/scales/{code}/qrcode:
    get:
      description: 根据量表编码获取小程序码
      parameters:
      - description: 量表编码
        in: path
        name: code
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.QRCodeResponse'
              type: object
      summary: 获取量表小程序码
      tags:
      - Scale-Query
  /api/v1/scales/{code}/questionnaire:
    put:
      consumes:
      - application/json
      description: 更新量表关联的问卷编码和版本
      parameters:
      - description: Bearer 用户令牌
        in: header
        name: Authorization
        required: true
        type: string
      - description: 量表编码
        in: path
        name: code
        required: true
        type: string
      - description: 更新请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/request.UpdateScaleQuestionnaireRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.ScaleResponse'
              type: object
      summary: 更新关联的问卷
      tags:
      - Scale-Lifecycle
  /api/v1/scales/{code}/unpublish:
    post:
      description: 下架量表使其不可用。量表编码通过 URL 路径参数传递，不需要请求体。
      parameters:
      - description: Bearer 用户令牌
        in: header
        name: Authorization
        required: true
        type: string
      - description: 量表编码
        in: path
        name: code
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.ScaleResponse'
              type: object
      summary: 下架量表
      tags:
      - Scale-Lifecycle
  /api/v1/scales/by-questionnaire:
    get:
      consumes:
      - application/json
      description: |-
        根据关联的问卷编码获取量表。
        响应字段说明：
        - category: 主类（adhd/tic/sensory/executive/mental/neurodev/chronic/qol）
        - stages: 阶段列表（数组，screening/deep_assessment/follow_up/outcome）
        - applicable_ages: 使用年龄列表（数组，infant/preschool/school_child/adolescent/adult）
        - reporters: 填报人列表（数组，可包含 parent/teacher/self/clinical）
        - tags: 标签列表（数组，动态输入）
        - scoring_params: 计分参数，map[string]interface{}，cnt 策略直接包含 cnt_option_contents 字段
        - max_score: 因子的最大分（可选）
        - is_show: 是否显示（用于报告中的维度展示）
        - risk_level: 因子级别的风险等级，从解读规则中提取（使用第一个规则的风险等级），有效值：none/low/medium/high/severe
      parameters:
      - description: Bearer 用户令牌
        in: header
        name: Authorization
        required: true
        type: string
      - description: 问卷编码
        in: query
        name: questionnaire_code
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.ScaleResponse'
              type: object
      summary: 根据问卷编码获取量表
      tags:
      - Scale-Query
  /api/v1/scales/categories:
    get:
      consumes:
      - application/json
      description: |-
        获取量表的主类、阶段、使用年龄、填报人等分类选项列表，用于前端渲染和配置量表字段。
        返回说明：
        - categories: 主类列表，包含8个选项（adhd, tic, sensory, executive, mental, neurodev, chronic, qol）
        - stages: 阶段列表，包含4个选项（screening, deep_assessment, follow_up, outcome）
        - applicable_ages: 使用年龄列表，包含5个选项（infant, preschool, school_child, adolescent, adult）
        - reporters: 填报人列表，包含4个选项（parent, teacher, self, clinical）
        - tags: 标签列表，返回空数组（标签已改为动态输入，通过后台输入设置）
      parameters:
      - description: Bearer 用户令牌
        in: header
        name: Authorization
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.ScaleCategoriesResponse'
              type: object
      summary: 获取量表分类列表
      tags:
      - Scale-Query
  /api/v1/scales/published:
    get:
      consumes:
      - application/json
      description: 分页获取已发布的量表列表（摘要信息，不包含因子详情）。响应中包含分类字段：category（主类）、stages（阶段列表）、applicable_ages（使用年龄列表）、reporters（填报人列表）、tags（标签列表）。
      parameters:
      - description: Bearer 用户令牌
        in: header
        name: Authorization
        required: true
        type: string
      - description: 页码
        in: query
        name: page
        required: true
        type: integer
      - description: 每页数量
        in: query
        name: page_size
        required: true
        type: integer
      - description: 标题模糊搜索
        in: query
        name: title
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.ScaleListResponse'
              type: object
      summary: 获取已发布量表列表
      tags:
      - Scale-Query
  /api/v1/scales/published/{code}:
    get:
      consumes:
      - application/json
      description: |-
        根据编码获取已发布的量表。
        响应字段说明：
        - category: 主类（adhd/tic/sensory/executive/mental/neurodev/chronic/qol）
        - stages: 阶段列表（数组，screening/deep_assessment/follow_up/outcome）
        - applicable_ages: 使用年龄列表（数组，infant/preschool/school_child/adolescent/adult）
        - reporters: 填报人列表（数组，可包含 parent/teacher/self/clinical）
        - tags: 标签列表（数组，动态输入）
        - scoring_params: 计分参数，map[string]interface{}，cnt 策略直接包含 cnt_option_contents 字段
        - max_score: 因子的最大分（可选）
        - is_show: 是否显示（用于报告中的维度展示）
        - risk_level: 因子级别的风险等级，从解读规则中提取（使用第一个规则的风险等级），有效值：none/low/medium/high/severe
      parameters:
      - description: Bearer 用户令牌
        in: header
        name: Authorization
        required: true
        type: string
      - description: 量表编码
        in: path
        name: code
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.ScaleResponse'
              type: object
      summary: 获取已发布的量表
      tags:
      - Scale-Query
  /api/v1/staff:
    get:
      parameters:
      - description: 机构ID
        in: query
        name: org_id
        required: true
        type: string
      - description: 角色筛选
        in: query
        name: role
        type: string
      - default: 1
        description: 页码
        in: query
        name: page
        type: integer
      - default: 20
        description: 每页数量
        in: query
        name: page_size
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.StaffListResponse'
              type: object
      summary: 查询员工列表
      tags:
      - Actor
    post:
      consumes:
      - application/json
      parameters:
      - description: 创建员工请求
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/request.CreateStaffRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.StaffResponse'
              type: object
      summary: 创建员工
      tags:
      - Actor
  /api/v1/staff/{id}:
    delete:
      parameters:
      - description: 员工ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/core.Response'
      summary: 删除员工
      tags:
      - Actor
    get:
      parameters:
      - description: 员工ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.StaffResponse'
              type: object
      summary: 获取员工详情
      tags:
      - Actor
  /api/v1/statistics/plans/{plan_id}:
    get:
      consumes:
      - application/json
      description: 获取指定测评计划的统计数据，包括任务数、完成率等
      parameters:
      - description: Bearer 用户令牌
        in: header
        name: Authorization
        required: true
        type: string
      - description: 计划ID
        format: int64
        in: path
        name: plan_id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/statistics.PlanStatistics'
              type: object
      summary: 获取计划统计
      tags:
      - Statistics
  /api/v1/statistics/questionnaires/{code}:
    get:
      consumes:
      - application/json
      description: 获取指定问卷/量表的统计数据，包括总提交数、完成数、趋势等
      parameters:
      - description: Bearer 用户令牌
        in: header
        name: Authorization
        required: true
        type: string
      - description: 问卷编码
        in: path
        name: code
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/statistics.QuestionnaireStatistics'
              type: object
      summary: 获取问卷/量表统计
      tags:
      - Statistics
  /api/v1/statistics/sync/accumulated:
    post:
      consumes:
      - application/json
      description: 将Redis中的累计统计数据同步到MySQL（定时任务调用）
      parameters:
      - description: Bearer 用户令牌（或内部调用token）
        in: header
        name: Authorization
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/core.Response'
      summary: 同步累计统计
      tags:
      - Statistics-Sync
  /api/v1/statistics/sync/daily:
    post:
      consumes:
      - application/json
      description: 将Redis中的每日统计数据同步到MySQL（定时任务调用）
      parameters:
      - description: Bearer 用户令牌（或内部调用token）
        in: header
        name: Authorization
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/core.Response'
      summary: 同步每日统计
      tags:
      - Statistics-Sync
  /api/v1/statistics/sync/plan:
    post:
      consumes:
      - application/json
      description: 同步计划统计数据到MySQL（定时任务调用）
      parameters:
      - description: Bearer 用户令牌（或内部调用token）
        in: header
        name: Authorization
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/core.Response'
      summary: 同步计划统计
      tags:
      - Statistics-Sync
  /api/v1/statistics/system:
    get:
      consumes:
      - application/json
      description: 获取系统整体统计数据，包括问卷数量、答卷数量、受试者数量等
      parameters:
      - description: Bearer 用户令牌
        in: header
        name: Authorization
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/statistics.SystemStatistics'
              type: object
      summary: 获取系统整体统计
      tags:
      - Statistics
  /api/v1/statistics/testees/{testee_id}:
    get:
      consumes:
      - application/json
      description: 获取指定受试者的统计数据，包括测评数、完成数、风险分布等
      parameters:
      - description: Bearer 用户令牌
        in: header
        name: Authorization
        required: true
        type: string
      - description: 受试者ID
        format: int64
        in: path
        name: testee_id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/statistics.TesteeStatistics'
              type: object
      summary: 获取受试者统计
      tags:
      - Statistics
  /api/v1/statistics/validate:
    post:
      consumes:
      - application/json
      description: 校验Redis和MySQL统计数据的一致性，修复不一致（定时任务调用）
      parameters:
      - description: Bearer 用户令牌（或内部调用token）
        in: header
        name: Authorization
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/core.Response'
      summary: 校验数据一致性
      tags:
      - Statistics-Sync
  /api/v1/testees:
    get:
      parameters:
      - description: 机构ID
        in: query
        name: org_id
        required: true
        type: string
      - description: 姓名（模糊匹配）
        in: query
        name: name
        type: string
      - description: 是否重点关注
        in: query
        name: is_key_focus
        type: boolean
      - default: 1
        description: 页码
        in: query
        name: page
        type: integer
      - default: 20
        description: 每页数量
        in: query
        name: page_size
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.TesteeListResponse'
              type: object
      summary: 查询受试者列表
      tags:
      - Actor
  /api/v1/testees/{id}:
    get:
      parameters:
      - description: 受试者ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.TesteeResponse'
              type: object
      summary: 获取受试者详情
      tags:
      - Actor
    put:
      consumes:
      - application/json
      parameters:
      - description: 受试者ID
        in: path
        name: id
        required: true
        type: string
      - description: 更新受试者请求
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/request.UpdateTesteeRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.TesteeResponse'
              type: object
      summary: 更新受试者
      tags:
      - Actor
  /api/v1/testees/{id}/periodic-stats:
    get:
      parameters:
      - description: Testee ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.PeriodicStatsResponse'
              type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/core.Response'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/core.Response'
      summary: 获取受试者周期统计
      tags:
      - Testee
  /api/v1/testees/{id}/plans:
    get:
      description: 查看某个受试者参与的所有计划
      parameters:
      - description: Bearer 用户令牌
        in: header
        name: Authorization
        required: true
        type: string
      - description: 受试者ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.PlanListResponse'
              type: object
      summary: 查询受试者参与的所有计划
      tags:
      - Plan-Query
  /api/v1/testees/{id}/plans/{plan_id}/tasks:
    get:
      description: 查看某个受试者在某个计划下的所有任务
      parameters:
      - description: Bearer 用户令牌
        in: header
        name: Authorization
        required: true
        type: string
      - description: 受试者ID
        in: path
        name: id
        required: true
        type: string
      - description: 计划ID
        in: path
        name: plan_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.TaskListResponse'
              type: object
      summary: 查询受试者在某个计划下的所有任务
      tags:
      - Plan-Query
  /api/v1/testees/{id}/scale-analysis:
    get:
      parameters:
      - description: Testee ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.ScaleAnalysisResponse'
              type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/core.Response'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/core.Response'
      summary: 获取受试者量表分析结果
      tags:
      - Testee
  /api/v1/testees/{id}/tasks:
    get:
      description: 查看某个受试者的所有任务
      parameters:
      - description: Bearer 用户令牌
        in: header
        name: Authorization
        required: true
        type: string
      - description: 受试者ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            allOf:
            - $ref: '#/definitions/core.Response'
            - properties:
                data:
                  $ref: '#/definitions/response.TaskListResponse'
              type: object
      summary: 查询受试者的所有任务
      tags:
      - Plan-Query
  /health:
    get:
      description: 检查 API Server 健康状态
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
      summary: 健康检查
      tags:
      - 系统
  /ping:
    get:
      description: 测试 API Server 连通性
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
      summary: Ping
      tags:
      - 系统
schemes:
- http
- https
swagger: "2.0"
