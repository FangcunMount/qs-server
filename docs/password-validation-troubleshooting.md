# å¯†ç éªŒè¯é—®é¢˜æ’æŸ¥æŒ‡å—

## ğŸ” é—®é¢˜ç°è±¡
è¯·æ±‚å‚æ•°ä¸­å¯†ç æ˜¯10ä½ï¼Œä½†æ˜¯ç³»ç»ŸæŠ¥é”™ã€‚

## ğŸ“‹ éªŒè¯è§„åˆ™è¯´æ˜

ç³»ç»Ÿä¸­æœ‰ä¸‰å±‚å¯†ç éªŒè¯ï¼š

### 1. HTTPè¯·æ±‚éªŒè¯å±‚
```go
// UserCreateRequest 
Password string `json:"password" valid:"required,stringlength(6|50)"`
```
- **éªŒè¯åº“**: `govalidator`
- **è§„åˆ™**: å¯†ç é•¿åº¦6-50ä¸ªå­—ç¬¦
- **å­—ç¬¦è®¡ç®—**: æŒ‰Unicodeå­—ç¬¦è®¡ç®—ï¼ˆä¸æ˜¯å­—èŠ‚ï¼‰

### 2. é¢†åŸŸæ¨¡å‹éªŒè¯å±‚
```go
// User.ChangePassword()
if len(newPassword) < 6 {
    return errors.WithCode(code.ErrUserBasicInfoInvalid, "password must be at least 6 characters")
}
```
- **è§„åˆ™**: å¯†ç é•¿åº¦è‡³å°‘6ä¸ªå­—ç¬¦
- **å­—ç¬¦è®¡ç®—**: æŒ‰Unicodeå­—ç¬¦è®¡ç®—

### 3. RouteréªŒè¯å±‚ï¼ˆå¯†ç ä¿®æ”¹ï¼‰
```go
// ChangePasswordRequest
NewPassword string `json:"new_password" binding:"required,min=6,max=50"`
```
- **éªŒè¯åº“**: Gin binding
- **è§„åˆ™**: å¯†ç é•¿åº¦6-50ä¸ªå­—ç¬¦

## ğŸš¨ å¯èƒ½çš„é—®é¢˜åŸå› 

### 1. **å…¶ä»–å­—æ®µéªŒè¯å¤±è´¥**
å¯†ç éªŒè¯é€šè¿‡ï¼Œä½†å…¶ä»–å¿…å¡«å­—æ®µå¯èƒ½æœ‰é—®é¢˜ï¼š

```json
{
  "username": "",           // âŒ ç”¨æˆ·åä¸ºç©º
  "password": "1234567890", // âœ… 10ä½å¯†ç æ­£å¸¸
  "nickname": "",           // âŒ æ˜µç§°ä¸ºç©º
  "email": "invalid",       // âŒ é‚®ç®±æ ¼å¼é”™è¯¯
  "phone": ""               // âŒ æ‰‹æœºå·ä¸ºç©º
}
```

### 2. **è¯·æ±‚æ ¼å¼é—®é¢˜**
- Content-Type ä¸æ˜¯ `application/json`
- JSONæ ¼å¼é”™è¯¯
- å­—æ®µåç§°æ‹¼å†™é”™è¯¯

### 3. **APIç«¯ç‚¹é”™è¯¯**
ç¡®ä¿ä½¿ç”¨æ­£ç¡®çš„ç«¯ç‚¹ï¼š
- ç”¨æˆ·æ³¨å†Œ: `POST /auth/register`
- å¯†ç ä¿®æ”¹: `POST /api/v1/users/change-password`

### 4. **å­—ç¬¦ç¼–ç é—®é¢˜**
åŒ…å«ç‰¹æ®Šå­—ç¬¦çš„å¯†ç å¯èƒ½æœ‰ç¼–ç é—®é¢˜ï¼š
```
"å¯†ç 123456"   // åŒ…å«ä¸­æ–‡
"pass@#$%"     // åŒ…å«ç‰¹æ®Šç¬¦å·
"testğŸ”word"   // åŒ…å«emoji
```

## ğŸ› ï¸ æ’æŸ¥æ­¥éª¤

### æ­¥éª¤1: æ£€æŸ¥å®Œæ•´è¯·æ±‚
ç¡®ä¿æ‰€æœ‰å¿…å¡«å­—æ®µéƒ½æä¾›ï¼š
```json
{
  "username": "testuser",
  "password": "1234567890",
  "nickname": "æµ‹è¯•ç”¨æˆ·",
  "email": "test@example.com",
  "phone": "13800138000",
  "introduction": "å¯é€‰å­—æ®µ"
}
```

### æ­¥éª¤2: éªŒè¯å­—æ®µæ ¼å¼
- **ç”¨æˆ·å**: éç©ºå­—ç¬¦ä¸²
- **å¯†ç **: 6-50ä¸ªå­—ç¬¦
- **æ˜µç§°**: éç©ºå­—ç¬¦ä¸²
- **é‚®ç®±**: æœ‰æ•ˆçš„é‚®ç®±æ ¼å¼
- **æ‰‹æœº**: éç©ºå­—ç¬¦ä¸²

### æ­¥éª¤3: æ£€æŸ¥HTTPå¤´
```bash
curl -H "Content-Type: application/json" \
     -X POST http://localhost:8080/auth/register \
     -d '{"username":"testuser","password":"1234567890",...}'
```

### æ­¥éª¤4: æŸ¥çœ‹å®Œæ•´é”™è¯¯ä¿¡æ¯
ä¸åªçœ‹HTTPçŠ¶æ€ç ï¼Œè¿˜è¦æŸ¥çœ‹å“åº”ä½“ä¸­çš„è¯¦ç»†é”™è¯¯ä¿¡æ¯ã€‚

## ğŸ§ª æµ‹è¯•ç”¨ä¾‹

### æœ‰æ•ˆçš„10ä½å¯†ç è¯·æ±‚
```bash
curl -H "Content-Type: application/json" \
     -X POST http://localhost:8080/auth/register \
     -d '{
       "username": "testuser10",
       "password": "1234567890",
       "nickname": "æµ‹è¯•ç”¨æˆ·",
       "email": "test@example.com",
       "phone": "13800138000"
     }'
```

### é¢„æœŸå“åº”ï¼ˆæˆåŠŸï¼‰
```json
{
  "code": 0,
  "data": {
    "id": 1,
    "username": "testuser10",
    "nickname": "æµ‹è¯•ç”¨æˆ·",
    "email": "test@example.com",
    "phone": "13800138000",
    "status": "init",
    "created_at": "2024-01-01T00:00:00Z",
    "updated_at": "2024-01-01T00:00:00Z"
  },
  "message": "ç”¨æˆ·åˆ›å»ºæˆåŠŸ"
}
```

### é¢„æœŸå“åº”ï¼ˆéªŒè¯å¤±è´¥ï¼‰
```json
{
  "code": 400,
  "error": "è¯·æ±‚æ ¼å¼é”™è¯¯",
  "details": "email: test@invalid does not validate as email"
}
```

## ğŸ”§ ä¿®å¤å»ºè®®

### 1. å¦‚æœæ˜¯é‚®ç®±æ ¼å¼é—®é¢˜
ç¡®ä¿é‚®ç®±åŒ…å« `@` å’Œæœ‰æ•ˆåŸŸåï¼š
```json
{
  "email": "user@example.com"  // âœ… æ­£ç¡®
  "email": "userexample.com"   // âŒ ç¼ºå°‘@
  "email": "user@"             // âŒ ç¼ºå°‘åŸŸå
}
```

### 2. å¦‚æœæ˜¯å­—æ®µç¼ºå¤±é—®é¢˜
æ£€æŸ¥æ‰€æœ‰å¿…å¡«å­—æ®µï¼š
```json
{
  "username": "å¿…å¡«",
  "password": "å¿…å¡«",
  "nickname": "å¿…å¡«", 
  "email": "å¿…å¡«",
  "phone": "å¿…å¡«"
}
```

### 3. å¦‚æœæ˜¯å¯†ç ç‰¹æ®Šå­—ç¬¦é—®é¢˜
å°è¯•ä½¿ç”¨çº¯è‹±æ–‡æ•°å­—å¯†ç æµ‹è¯•ï¼š
```json
{
  "password": "testpass123"  // çº¯è‹±æ–‡æ•°å­—
}
```

## ğŸ“± å¿«é€Ÿæµ‹è¯•

ä½¿ç”¨æä¾›çš„æµ‹è¯•è„šæœ¬ï¼š
```bash
./test_api.sh
```

è¯¥è„šæœ¬ä¼šè‡ªåŠ¨æµ‹è¯•ï¼š
- æœåŠ¡å™¨è¿é€šæ€§
- 10ä½å¯†ç ç”¨æˆ·åˆ›å»º
- ä¸åŒå¯†ç é•¿åº¦
- å­—æ®µéªŒè¯
- é‚®ç®±æ ¼å¼éªŒè¯

## ğŸ†˜ å¦‚æœé—®é¢˜ä»ç„¶å­˜åœ¨

è¯·æä¾›ä»¥ä¸‹ä¿¡æ¯ï¼š
1. **å®Œæ•´çš„è¯·æ±‚æ•°æ®**ï¼ˆJSONæ ¼å¼ï¼‰
2. **å®Œæ•´çš„é”™è¯¯å“åº”**ï¼ˆåŒ…æ‹¬çŠ¶æ€ç å’Œå“åº”ä½“ï¼‰
3. **ä½¿ç”¨çš„APIç«¯ç‚¹**
4. **è¯·æ±‚æ–¹æ³•**ï¼ˆPOST/PUTç­‰ï¼‰
5. **Content-Typeå¤´ä¿¡æ¯**

è¿™æ ·å¯ä»¥æ›´ç²¾ç¡®åœ°å®šä½é—®é¢˜æ‰€åœ¨ã€‚ 