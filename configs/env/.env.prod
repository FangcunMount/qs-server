# ==========================================
# QS-Server 生产环境配置
# Production Environment Configuration
# ==========================================
#
# ⚠️  重要提示：
# 1. 生产环境必须使用强密码
# 2. 不要在代码仓库中存储真实的生产密码
# 3. 建议使用密钥管理服务（如 Vault、AWS Secrets Manager）
# 4. 本文件仅作为模板，请根据实际环境修改
#
# ==========================================

# ==========================================
# 🌍 环境基础配置
# ==========================================
APP_ENV=production
NODE_ENV=production
ENV=prod
LOG_LEVEL=info
DEBUG=false
TZ=Asia/Shanghai
LANG=zh_CN.UTF-8

# ==========================================
# 📍 服务端口配置
# ==========================================
# QS API Server
QS_APISERVER_HTTP_PORT=8080
QS_APISERVER_HTTPS_PORT=8443
QS_APISERVER_GRPC_PORT=9090
QS_APISERVER_GRPC_HEALTH_PORT=9091

# Collection Server
COLLECTION_SERVER_HTTP_PORT=8081
COLLECTION_SERVER_HTTPS_PORT=8444

# ==========================================
# 🗄️  MySQL 数据库配置
# ==========================================
MYSQL_HOST=<YOUR_MYSQL_HOST>
MYSQL_PORT=3306
MYSQL_ROOT_PASSWORD=<YOUR_MYSQL_ROOT_PASSWORD>

# QS-Server 应用数据库配置
MYSQL_DATABASE=questionnaire_scale
MYSQL_USER=<YOUR_MYSQL_USER>
MYSQL_PASSWORD=<YOUR_MYSQL_PASSWORD>

# MySQL 连接配置
MYSQL_MAX_IDLE_CONNECTIONS=20
MYSQL_MAX_OPEN_CONNECTIONS=200
MYSQL_MAX_CONNECTION_LIFE_TIME=2h
MYSQL_LOG_LEVEL=2

# ==========================================
# 🔐 Redis 配置（单实例）
# ==========================================
REDIS_HOST=<YOUR_REDIS_HOST>
REDIS_PORT=6379
REDIS_USERNAME=<YOUR_REDIS_USERNAME>
REDIS_PASSWORD=<YOUR_REDIS_PASSWORD>
REDIS_DB=0
REDIS_MAX_IDLE=100
REDIS_MAX_ACTIVE=200
REDIS_TIMEOUT=5
REDIS_ENABLE_CLUSTER=false
REDIS_USE_SSL=false

# ==========================================
# 🍃 MongoDB 配置
# ==========================================
MONGO_HOST=<YOUR_MONGO_HOST>
MONGO_PORT=27017
MONGO_INITDB_ROOT_USERNAME=root
MONGO_INITDB_ROOT_PASSWORD=<YOUR_MONGO_ROOT_PASSWORD>

# QS-Server 应用数据库配置
MONGO_DATABASE=questionnaire_scale
MONGO_USER=<YOUR_MONGO_USER>
MONGO_PASSWORD=<YOUR_MONGO_PASSWORD>

# MongoDB 连接 URL（应用使用）
MONGO_URL=mongodb://<YOUR_MONGO_USER>:<YOUR_MONGO_PASSWORD>@<YOUR_MONGO_HOST>:27017/questionnaire_scale
MONGO_USE_SSL=true
MONGO_SSL_INSECURE_SKIP_VERIFY=false
MONGO_SSL_ALLOW_INVALID_HOSTNAMES=false

# ==========================================
# 📬 NSQ 配置
# ==========================================
NSQ_HOST=<YOUR_NSQ_HOST>
NSQLOOKUPD_TCP_PORT=4160
NSQLOOKUPD_HTTP_PORT=4161
NSQD_TCP_PORT=4150
NSQD_HTTP_PORT=4151
NSQADMIN_PORT=4171

# NSQ 连接地址
NSQLOOKUPD_TCP_ADDRESS=<YOUR_NSQ_HOST>:4160
NSQD_TCP_ADDRESS=<YOUR_NSQ_HOST>:4150
NSQLOOKUPD_HTTP_ADDRESS=http://<YOUR_NSQ_HOST>:4161
NSQD_HTTP_ADDRESS=http://<YOUR_NSQ_HOST>:4151

# ==========================================
# 🔑 JWT 配置
# ==========================================
# ⚠️  生产环境必须使用强密钥（建议 64 位以上随机字符串）
JWT_REALM="qs jwt"
JWT_SECRET_KEY=<YOUR_JWT_SECRET_KEY>
JWT_TIMEOUT=24h
JWT_MAX_REFRESH=168h

# Collection Server JWT
COLLECTION_JWT_SECRET_KEY=<YOUR_COLLECTION_JWT_SECRET_KEY>
COLLECTION_JWT_TOKEN_DURATION=168

# ==========================================
# 📊 日志配置
# ==========================================
LOG_NAME=qs-server
LOG_FORMAT=json
LOG_ENABLE_COLOR=false
LOG_DISABLE_CALLER=true
LOG_DISABLE_STACKTRACE=true
LOG_DEVELOPMENT=false

# 日志文件配置
LOG_DIR=/data/logs/qs
LOG_MAX_SIZE=100
LOG_MAX_AGE=30
LOG_MAX_BACKUPS=10
LOG_COMPRESS=true

# ==========================================
# 🚀 数据库迁移配置
# ==========================================
MIGRATION_ENABLED=true
MIGRATION_AUTOSEED=false
MIGRATION_DATABASE=questionnaire_scale

# ==========================================
# 🔒 TLS/SSL 证书配置
# ==========================================
TLS_CERT_DIR=/app/configs/cert
QS_APISERVER_CERT_FILE=/app/configs/cert/qs-apiserver.crt
QS_APISERVER_KEY_FILE=/app/configs/cert/qs-apiserver.key
COLLECTION_SERVER_CERT_FILE=/app/configs/cert/collection-server.crt
COLLECTION_SERVER_KEY_FILE=/app/configs/cert/collection-server.key

# ==========================================
# 🌐 GRPC 客户端配置
# ==========================================
GRPC_CLIENT_ENDPOINT=<YOUR_GRPC_ENDPOINT>:9090
GRPC_CLIENT_TIMEOUT=30
GRPC_CLIENT_INSECURE=false

# ==========================================
# 🏗️  服务器模式配置
# ==========================================
SERVER_MODE=release
SERVER_HEALTHZ=true
SERVER_MAX_PING_COUNT=3

# Gin 中间件配置
SERVER_MIDDLEWARES=recovery,enhanced_logger,secure,nocache,cors

# ==========================================
# 💾 数据与日志路径
# ==========================================
DATA_ROOT_PATH=/data
LOG_ROOT_PATH=/data/logs

# ==========================================
# 📝 生产环境说明
# ==========================================
# 
# 1. 密码管理：
#    - 使用强密码（至少 16 位，包含大小写字母、数字、特殊字符）
#    - 定期更换密码
#    - 使用密钥管理服务存储敏感信息
# 
# 2. 安全配置：
#    - 启用 SSL/TLS
#    - 关闭调试模式
#    - 最小化日志输出
#    - 禁用不必要的中间件
# 
# 3. 性能优化：
#    - 适当增加连接池大小
#    - 调整超时时间
#    - 启用缓存
# 
# 4. 监控告警：
#    - 配置健康检查
#    - 设置告警阈值
#    - 集成监控系统
# 
# 5. 备份恢复：
#    - 定期备份数据库
#    - 测试恢复流程
#    - 制定灾难恢复计划
# 
# ==========================================
