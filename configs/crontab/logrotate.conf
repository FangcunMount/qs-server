# ============================================================
# QS Server 定时任务日志轮转配置
# ============================================================
# 文件路径：/etc/logrotate.d/qs-scheduler
# 用途：定时任务日志轮转配置
# 维护人：DevOps Team
# 最后更新：2025-01-XX
# 
# 部署说明：
# 1. 复制此文件到 /etc/logrotate.d/qs-scheduler
# 2. 测试配置：logrotate -d /etc/logrotate.d/qs-scheduler
# 3. 手动执行：logrotate -f /etc/logrotate.d/qs-scheduler
# ============================================================

/data/logs/crontab/*.log {
    # 每天轮转一次
    daily
    
    # 保留 30 天的日志
    rotate 30
    
    # 压缩旧日志
    compress
    
    # 延迟压缩（下次轮转时再压缩）
    delaycompress
    
    # 如果日志文件不存在，不报错
    missingok
    
    # 如果日志文件为空，不轮转
    notifempty
    
    # 创建新日志文件的权限
    create 0644 root root
    
    # 共享脚本（所有匹配的文件轮转完成后执行一次）
    sharedscripts
    
    # 轮转后执行的脚本（可选，用于通知或清理）
    postrotate
        # 如果需要重新加载 syslog，取消下面的注释
        # /bin/kill -HUP `cat /var/run/syslogd.pid 2> /dev/null` 2> /dev/null || true
        
        # 可以在这里添加其他清理或通知脚本
        # 例如：发送告警、清理临时文件等
    endscript
}

